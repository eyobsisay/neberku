<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Owner Dashboard - Neberku</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
    <link href="css/custom.css" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
        <div class="container">
            <a class="navbar-brand" href="index.html">
                <i class="bi bi-camera-video"></i> Neberku
            </a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="index.html">Home</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link active" href="dashboard.html">Dashboard</a>
                    </li>
                </ul>
                <div class="navbar-nav">
                    <span class="navbar-text me-3">
                        <i class="bi bi-person-circle"></i> <span id="userDisplayName">Event Owner</span>
                    </span>
                    <button class="btn btn-outline-light" onclick="logoutUser()">
                        <i class="bi bi-box-arrow-right"></i> Logout
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mt-5 pt-5">
        <!-- Dashboard Header -->
        <div class="row mb-4">
            <div class="col-12">
                <h1 class="display-4 text-primary">
                    <i class="bi bi-speedometer2"></i> Event Dashboard
                </h1>
                <p class="lead">Manage your events and view guest contributions</p>
            </div>
        </div>

        <!-- Stats Cards -->
        <div class="row mb-4">
            <div class="col-md-3 mb-3">
                <div class="card bg-primary text-white h-100">
                    <div class="card-body text-center">
                        <i class="bi bi-calendar-event display-4"></i>
                        <h3 class="card-title" id="totalEvents">0</h3>
                        <p class="card-text">Total Events</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="card bg-success text-white h-100">
                    <div class="card-body text-center">
                        <i class="bi bi-image display-4"></i>
                        <h3 class="card-title" id="totalPhotos">0</h3>
                        <p class="card-text">Photos Collected</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="card bg-info text-white h-100">
                    <div class="card-body text-center">
                        <i class="bi bi-camera-video display-4"></i>
                        <h3 class="card-title" id="totalVideos">0</h3>
                        <p class="card-text">Videos Collected</p>
                    </div>
                </div>
            </div>
            <div class="col-md-3 mb-3">
                <div class="card bg-warning text-white h-100">
                    <div class="card-body text-center">
                        <i class="bi bi-people display-4"></i>
                        <h3 class="card-title" id="totalGuests">0</h3>
                        <p class="card-text">Guest Contributors</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- Create New Event -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header">
                        <h5 class="mb-0">
                            <i class="bi bi-plus-circle"></i> Create New Event
                        </h5>
                    </div>
                    <div class="card-body">
                        <!-- Show button by default -->
                        <div id="createEventButton" class="text-center">
                            <button type="button" class="btn btn-primary btn-lg" onclick="dashboard.showCreateEventForm()">
                                <i class="bi bi-plus-circle"></i> Create New Event
                            </button>
                            <p class="text-muted mt-2">Click to start creating your next amazing event</p>
                        </div>
                        
                        <!-- Hide form by default -->
                        <form id="createEventForm" novalidate style="display: none;">
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="eventTitle" class="form-label">Event Title <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="eventTitle" required>
                                    <div class="invalid-feedback"></div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="eventDate" class="form-label">Event Date <span class="text-danger">*</span></label>
                                    <input type="date" class="form-control" id="eventDate" required>
                                    <div class="invalid-feedback"></div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="eventLocation" class="form-label">Location <span class="text-danger">*</span></label>
                                    <input type="text" class="form-control" id="eventLocation" required>
                                    <div class="invalid-feedback"></div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="eventDescription" class="form-label">Description <span class="text-danger">*</span></label>
                                    <textarea class="form-control" id="eventDescription" rows="3" required></textarea>
                                    <div class="invalid-feedback"></div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="eventPackage" class="form-label">Package <span class="text-danger">*</span></label>
                                    <select class="form-control" id="eventPackage" required>
                                        <option value="">Loading packages...</option>
                                    </select>
                                    <div class="invalid-feedback"></div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="eventType" class="form-label">Event Type <span class="text-danger">*</span></label>
                                    <select class="form-control" id="eventType" required>
                                        <option value="">Loading event types...</option>
                                    </select>
                                    <div class="invalid-feedback"></div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="eventThumbnail" class="form-label">Event Thumbnail (Optional)</label>
                                    <input type="file" class="form-control" id="eventThumbnail" accept="image/*">
                                    <div class="form-text">Upload an image for your event (JPG, PNG, GIF, WebP)</div>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="eventVideo" class="form-label">Event Video (Optional)</label>
                                    <input type="file" class="form-control" id="eventVideo" accept="video/*">
                                    <div class="form-text">Upload a video for your event (MP4, MOV, AVI, WebM)</div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="allowPhotos" class="form-label">Allow Photos</label>
                                    <select class="form-control" id="allowPhotos">
                                        <option value="true">Yes</option>
                                        <option value="false">No</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="allowVideos" class="form-label">Allow Videos</label>
                                    <select class="form-control" id="allowVideos">
                                        <option value="true">Yes</option>
                                        <option value="false">No</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="allowWishes" class="form-label">Allow Wishes</label>
                                    <select class="form-control" id="allowWishes">
                                        <option value="true">Yes</option>
                                        <option value="false">No</option>
                                    </select>
                                </div>
                                <div class="col-md-6 mb-3">
                                    <label for="autoApprovePosts" class="form-label">Auto-approve Posts</label>
                                    <select class="form-control" id="autoApprovePosts">
                                        <option value="false">No (Manual approval)</option>
                                        <option value="true">Yes (Auto-approve)</option>
                                    </select>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-md-6 mb-3">
                                    <label for="isPublic" class="form-label">Event Visibility</label>
                                    <select class="form-control" id="isPublic">
                                        <option value="false">Private (Code Required)</option>
                                        <option value="true">Public (Discoverable)</option>
                                    </select>
                                    <div class="form-text">Private events require contributor codes, public events can be discovered</div>
                                </div>
                            </div>
                            <div class="d-flex gap-2">
                                <button type="submit" class="btn btn-primary">
                                    <i class="bi bi-plus-circle"></i> Create Event
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="dashboard.hideCreateEventForm()">
                                    <i class="bi bi-x-circle"></i> Cancel
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>

        <!-- Event Status Overview -->
        <div class="row mb-4">
            <div class="col-12">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">
                            <i class="bi bi-activity"></i> Event Status Overview
                        </h5>
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-outline-primary btn-sm" onclick="dashboard.refreshEventStatus()">
                                <i class="bi bi-arrow-clockwise"></i> Refresh
                            </button>
                            <button type="button" class="btn btn-outline-warning btn-sm" onclick="dashboard.debugEventData()">
                                <i class="bi bi-bug"></i> Debug
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-3 mb-3">
                                <div class="d-flex align-items-center p-3 bg-primary bg-opacity-10 rounded">
                                    <div class="flex-shrink-0">
                                        <i class="bi bi-calendar-check text-primary fs-1"></i>
                                    </div>
                                    <div class="flex-grow-1 ms-3">
                                        <h4 class="mb-0 text-primary" id="activeEvents">0</h4>
                                        <p class="mb-0 text-muted">Active Events</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="d-flex align-items-center p-3 bg-warning bg-opacity-10 rounded">
                                    <div class="flex-shrink-0">
                                        <i class="bi bi-clock text-warning fs-1"></i>
                                    </div>
                                    <div class="flex-grow-1 ms-3">
                                        <h4 class="mb-0 text-warning" id="pendingEvents">0</h4>
                                        <p class="mb-0 text-muted">Pending Events</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="d-flex align-items-center p-3 bg-success bg-opacity-10 rounded">
                                    <div class="flex-shrink-0">
                                        <i class="bi bi-check-circle text-success fs-1"></i>
                                    </div>
                                    <div class="flex-grow-1 ms-3">
                                        <h4 class="mb-0 text-success" id="completedEvents">0</h4>
                                        <p class="mb-0 text-muted">Completed Events</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3 mb-3">
                                <div class="d-flex align-items-center p-3 bg-info bg-opacity-10 rounded">
                                    <div class="flex-shrink-0">
                                        <i class="bi bi-calendar-plus text-info fs-1"></i>
                                    </div>
                                    <div class="flex-grow-1 ms-3">
                                        <h4 class="mb-0 text-info" id="draftEvents">0</h4>
                                        <p class="mb-0 text-muted">Draft Events</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Second row for cancelled events -->
                        <div class="row mt-3">
                            <div class="col-md-3 mb-3">
                                <div class="d-flex align-items-center p-3 bg-danger bg-opacity-10 rounded">
                                    <div class="flex-shrink-0">
                                        <i class="bi bi-exclamation-triangle text-danger fs-1"></i>
                                    </div>
                                    <div class="flex-grow-1 ms-3">
                                        <h4 class="mb-0 text-danger" id="cancelledEvents">0</h4>
                                        <p class="mb-0 text-muted">Cancelled Events</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Event Status Timeline -->
                        <div class="row mt-3">
                            <div class="col-12">
                                <h6 class="text-muted mb-3">
                                    <i class="bi bi-clock-history"></i> Recent Event Activity
                                </h6>
                                <div id="eventStatusTimeline" class="border-start border-2 border-primary ps-3">
                                    <!-- Timeline items will be loaded here -->
                                    <p class="text-muted text-center py-3">No recent activity</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Events List -->
        <div class="row">
            <div class="col-12">
                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center">
                        <h5 class="mb-0">
                            <i class="bi bi-list-ul"></i> Your Events
                        </h5>
                        <div class="btn-group" role="group">
                            <button type="button" class="btn btn-outline-primary btn-sm" onclick="dashboard.filterEvents('all')">
                                All Events
                            </button>
                            <button type="button" class="btn btn-outline-success btn-sm" onclick="dashboard.filterEvents('active')">
                                Active
                            </button>
                            <button type="button" class="btn btn-outline-warning btn-sm" onclick="dashboard.filterEvents('pending')">
                                Pending
                            </button>
                            <button type="button" class="btn btn-outline-success btn-sm" onclick="dashboard.filterEvents('completed')">
                                Completed
                            </button>
                            <button type="button" class="btn btn-outline-danger btn-sm" onclick="dashboard.filterEvents('cancelled')">
                                Cancelled
                            </button>
                        </div>
                    </div>
                    <div class="card-body">
                        <div id="eventsList" class="row">
                            <!-- Events will be loaded here -->
                        </div>
                    </div>
                </div>
            </div>
        </div>


    </main>

    <!-- Footer -->
    <footer class="bg-dark text-light py-4 mt-5">
        <div class="container text-center">
            <p>&copy; 2024 Neberku. All rights reserved.</p>
        </div>
    </footer>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="js/config.js"></script>
    <script src="js/auth.js"></script>
    <script src="js/dashboard.js"></script>
</body>
</html> 